<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2 ng-bind-template="Edit workorder #{{editableWorkOrder.WorkOrder}}" ng-cloak></h2>
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox">
        <tabset>
            <tab heading="General">
                <form role="form" name="edit_workorder_form" novalidate ng-submit="saveWorkOrder()">
                    <div class="row">
                        <!--1-->
                    <div class="col-lg-4 col-md-6">
                        <div class="ibox">
                            <div class="ibox-content">
                                <div class="form-group">
                                    <label>Customer</label>
                                    <ui-select ng-model="lookups.Customers.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Customer">{{$select.selected.Name}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Customers | filter: $select.search | limitTo:100">
                                            <div>{{item.Name}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>

                                <div class="form-group">
                                    <label>Location</label>
                                    <ui-select ng-model="lookups.Locations.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Location">{{$select.selected.Name}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Locations | filter: $select.search | limitTo:100">
                                            <div>{{item.Name}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <div class="form-group">
                                    <label>Call Type</label>
                                    <ui-select ng-model="lookups.Calltypes.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Call Type">{{$select.selected.Description}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Calltypes | filter: $select.search">
                                            <div>{{item.Description}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <div class="form-group">
                                    <label>Call Date</label>
                                    <div class="input-group date">
                                        <input type="datetime" class="form-control" date-time ng-model="obj.calldate" view="date" auto-close="true" min-view="date" format="MM/DD/YYYY">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Problem</label>
                                    <ui-select ng-model="lookups.Problems.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Problem">{{$select.selected.Description}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Problems | filter: $select.search">
                                            <div>{{item.Description}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <!-- 1.2-->
                                <div class="form-group hidden-lg">
                                    <label>Rate Sheet</label>
                                    <ui-select ng-model="lookups.RateSheets.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Rate Sheet">{{$select.selected.DESCRIPTION}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.RateSheets | filter: $select.search">
                                            <div>{{item.DESCRIPTION}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <div class="form-group hidden-lg">
                                    <label>Employee</label>
                                    <ui-select ng-model="lookups.Employes.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Employee">{{$select.selected.Name}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Employes | filter: $select.search">
                                            <div>{{item.Name}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <!--md 1.2-->
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Estimated Repair Hours</label>
                                    <ui-select ng-model="lookups.Hours.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Estimated Repair Hours">{{$select.selected.Description}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.Hours | filter: $select.search">
                                            <div>{{item.Description}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Not to Exceed</label>
                                    <input type="text" placeholder="Not to Exceed" class="form-control" name="notToExceed" ng-model="obj.nottoexceed" required>
                                    <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                        <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                    </div>
                                </div>
                                <!-- 1.3-->
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Location comments</label>
                                    <input type="text" placeholder="Location comments" class="form-control" name="locationComments" ng-model="obj.locationcomments" required>
                                    <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                        <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                    </div>
                                </div>
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Customer PO</label>
                                    <input type="text" placeholder="Customer PO" class="form-control" name="CustomerPO" ng-model="obj.customerpo" required>
                                    <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                        <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                    </div>
                                </div>
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Persmission Code</label>
                                    <ui-select ng-model="lookups.PermissionCodes.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Persmission Code">{{$select.selected.DESCRIPTION}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.PermissionCodes | filter: $select.search">
                                            <div>{{item.DESCRIPTION}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                                <div class="form-group hidden-lg hidden-md">
                                    <label>Payment method</label>
                                    <ui-select ng-model="lookups.PaymentMethods.selected" theme="bootstrap">
                                        <ui-select-match placeholder="Payment method">{{$select.selected.Method}}</ui-select-match>
                                        <ui-select-choices repeat="item in lookups.PaymentMethods | filter: $select.search">
                                            <div>{{item.Method}}</div>
                                        </ui-select-choices>
                                    </ui-select>
                                </div>
                            </div>
                        </div>
                    </div>
                        <!--2 md-->
                        <div class="col-md-6 visible-md">
                            <div class="ibox">
                                <div class="ibox-content">
                                    <div class="form-group hidden-lg">
                                        <label>Estimated Repair Hours</label>
                                        <ui-select ng-model="lookups.Hours.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Estimated Repair Hours">{{$select.selected.Description}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.Hours | filter: $select.search">
                                                <div>{{item.Description}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group hidden-lg">
                                        <label>Not to Exceed</label>
                                        <input type="text" placeholder="Not to Exceed" class="form-control" name="notToExceed" ng-model="obj.nottoexceed" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                    <!-- 1.3-->
                                    <div class="form-group hidden-lg">
                                        <label>Location comments</label>
                                        <input type="text" placeholder="Location comments" class="form-control" name="locationComments" ng-model="obj.locationcomments" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                    <div class="form-group hidden-lg">
                                        <label>Customer PO</label>
                                        <input type="text" placeholder="Customer PO" class="form-control" name="CustomerPO" ng-model="obj.customerpo" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                    <div class="form-group hidden-lg">
                                        <label>Persmission Code</label>
                                        <ui-select ng-model="lookups.PermissionCodes.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Persmission Code">{{$select.selected.DESCRIPTION}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.PermissionCodes | filter: $select.search">
                                                <div>{{item.DESCRIPTION}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group hidden-lg">
                                        <label>Payment method</label>
                                        <ui-select ng-model="lookups.PaymentMethods.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Payment method">{{$select.selected.Method}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.PaymentMethods | filter: $select.search">
                                                <div>{{item.Method}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--2 lg-->
                        <div class="col-lg-4 visible-lg">
                            <div class="ibox">
                                <div class="ibox-content">
                                    <div class="form-group">
                                        <label>Rate Sheet</label>
                                        <ui-select ng-model="lookups.RateSheets.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Rate Sheet">{{$select.selected.DESCRIPTION}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.RateSheets | filter: $select.search">
                                                <div>{{item.DESCRIPTION}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group">
                                        <label>Employee</label>
                                        <ui-select ng-model="lookups.Employes.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Employee">{{$select.selected.Name}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.Employes | filter: $select.search">
                                                <div>{{item.Name}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group">
                                        <label>Estimated Repair Hours</label>
                                        <ui-select ng-model="lookups.Hours.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Estimated Repair Hours">{{$select.selected.Description}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.Hours | filter: $select.search">
                                                <div>{{item.Description}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group">
                                        <label>Not to Exceed</label>
                                        <input type="text" placeholder="Not to Exceed" class="form-control" name="notToExceed" ng-model="obj.nottoexceed" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--3 lg-->
                        <div class="col-lg-4 visible-lg">
                            <div class="ibox">
                                <div class="ibox-content">
                                    <div class="form-group">
                                        <label>Location comments</label>
                                        <input type="text" placeholder="Location comments" class="form-control" name="locationComments" ng-model="obj.locationcomments" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Customer PO</label>
                                        <input type="text" placeholder="Customer PO" class="form-control" name="CustomerPO" ng-model="obj.customerpo" required>
                                        <div class="m-t-xs" ng-show="signup_form.email.$invalid && signup_form.submitted">
                                            <small class="text-danger" ng-show="signup_form.email.$error">Please input a valid email address</small>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Persmission Code</label>
                                        <ui-select ng-model="lookups.PermissionCodes.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Persmission Code">{{$select.selected.DESCRIPTION}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.PermissionCodes | filter: $select.search">
                                                <div>{{item.DESCRIPTION}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                    <div class="form-group">
                                        <label>Payment method</label>
                                        <ui-select ng-model="lookups.PaymentMethods.selected" theme="bootstrap">
                                            <ui-select-match placeholder="Payment method">{{$select.selected.Method}}</ui-select-match>
                                            <ui-select-choices repeat="item in lookups.PaymentMethods | filter: $select.search">
                                                <div>{{item.Method}}</div>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>


</form>

            </tab>
            <tab heading="Parts and Labor">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-content">
                                <table class="footable table table-stripped equip">
                                    <thead>
                                        <tr>
                                            <th>Work Date</th>
                                            <th>Type</th>
                                            <th>Description</th>
                                            <th>Employee</th>
                                            <th>Cost Qty</th>
                                            <th>Biled Qty or S/N</th>
                                            <th>Rate</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="gradeX" ng-repeat="equipm in equipment track by $index">
                                            <td ng-if="equipm.isEditing == true">
                                                <div class="input-group date">
                                                    <input type="datetime" class="form-control" date-time ng-model="equipm.date" view="date" auto-close="true" min-view="date" format="YYYY-MM-DD">
                                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                </div>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.date}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <ui-select ng-model="equipm.equipType.selected" theme="bootstrap">
                                                    <ui-select-match placeholder="Type">{{$select.selected}}</ui-select-match>
                                                    <ui-select-choices repeat="item in equipm.equipType | filter: $select.search">
                                                        <div>{{item}}</div>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.equipType}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <ui-select ng-if="equipm.equipType.selected == 'Labor'" ng-model="equipm.labor.selected" theme="bootstrap"
                                                           on-select="setRate(this, equipm)">
                                                    <ui-select-match placeholder="Description">{{$select.selected.Description}}</ui-select-match>
                                                    <ui-select-choices repeat="item in equipm.labor | filter: $select.search | limitTo:100">
                                                        <div>{{item.Description}}</div>
                                                    </ui-select-choices>
                                                </ui-select>
                                                <ui-select ng-if="equipm.equipType.selected == 'Parts' || !equipm.equipType.selected" ng-model="equipm.parts.selected" theme="bootstrap"
                                                           on-select="setRate(this, equipm)">
                                                    <ui-select-match placeholder="Description">{{$select.selected.Description}}</ui-select-match>
                                                    <ui-select-choices repeat="item in equipm.parts | filter: $select.search | limitTo:100">
                                                        <div>{{item.Description}}</div>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.description}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <ui-select ng-model="equipm.empl.selected" theme="bootstrap">
                                                    <ui-select-match placeholder="Employee">{{$select.selected.Name}}</ui-select-match>
                                                    <ui-select-choices repeat="item in equipm.empl | filter: $select.search">
                                                        <div>{{item.Name}}</div>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.empl}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <div class="input-group" ng-if="equipm.equipType.selected == 'Labor'">
                                                    <input type="number" class="form-control" ng-model="equipm.cost" step="0.01" min="0.00" value="0.00">
                                                </div>
                                                <div class="input-group" ng-if="equipm.equipType.selected == 'Parts'  || !equipm.equipType.selected">
                                                    <input type="number" class="form-control" ng-model="equipm.cost" disabled="disabled" step="0.01" min="0.00" value="0.00">
                                                </div>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.cost}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <div class="input-group">
                                                    <input type="number" class="form-control" ng-model="equipm.biled" step="1" min="0" value="1">
                                                </div>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.biled}}</label>
                                            </td>
                                            <td ng-if="equipm.isEditing == true">
                                                <div class="input-group">
                                                    <input type="number" class="form-control" ng-model="equipm.rate" step="0.0001" min="0.0000" value="0">
                                                </div>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <label>{{equipm.rate}}</label>
                                            </td>


                                            <td class="center" ng-if="equipm.isEditing == true">
                                                <a class="btn btn-danger btn-xs" ng-click="saveRow(equipm, $index)">Save</a>
                                            </td>
                                            <td ng-if="equipm.isEditing == false">
                                                <a class="btn btn-danger btn-xs" ng-click="editRow(equipm, $index)">Edit</a>
                                                <a class="btn btn-danger btn-xs" ng-click="deleteRow($event, equipm)">Remove</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </tab>
            <tab heading="Pictures">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-content">
                                <div class="wogalary">
                                    <div ng-repeat="picture in pictures.Images">
                                        {{picture.Id}}.
                                        <a href="#" title="{{picture.Description}}" ng-click="displayLocation(picture.Latitude, picture.Longitude, picture, pictures.WorkOrder)" data-toggle="modal" data-target="#myModal">
                                            <img src="public/images/{{pictures.WorkOrder}}/{{picture.Image}}" alt="{{picture.Description}}">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </tab>
        </tabset>
        <div class="row">
            <div class="col-lg-12">
                <div class="form-group">
                    <button class="btn btn-sm btn-primary" type="submit" ng-click="saveWorkOrder()"><strong>Save</strong></button>
                    <button class="btn btn-sm btn-danger" type="cancel" back><strong>Cancel</strong></button>
                </div>
            </div>
        </div>
        <div class="modal inmodal" id="myModal" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;">
            <div class="modal-dialog">
                <div class="modal-content animated bounceInRight">
                    <div class="modal-body">
                        <div class="ibox">
                            <div class="ibox-content">
                                <section id="map">
                                    <div ui-map="locationMap" ui-options="mapOptions" class="google-map" style="height: 700px; min-height: 100%;"></div>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>